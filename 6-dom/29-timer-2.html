<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Timer 2</title>
</head>
<body>
<button id="btn">点我一下</button>
<script>
    "use strict";

    /*
     * # 定时器
     *
     * - 定时器的本质，就是在指定时间后将函数添加到消息队列中
     * - `setInterval()`
     *   - 每间隔一段时间就将函数添加到消息队列中
     *   - 但如果函数执行的速度比较慢，它无法确保每次执行的间隔都是一样的
     */
    function setEqualInterval(handler, timeout) {
        const f = () => {
            handler();
            setTimeout(f, timeout);
        };

        setTimeout(f, timeout);
    }

    document.getElementById("btn").addEventListener("click", () => {
        if (confirm("setInterval?")) {
            console.time();
            setInterval(() => {
                console.timeEnd();
                alert();
                console.time();
            }, 3000);
        } else {
            console.time();
            setEqualInterval(() => {
                console.timeEnd();
                alert();
                console.time();
            }, 3000);
        }
    });
</script>
</body>
</html>
